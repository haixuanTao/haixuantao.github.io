import{c as g,f as m}from"./connect-DkGLCYAo.js";const d=document.getElementById("log"),r=document.getElementById("start"),c=document.getElementById("stop");let o=null,s=!1;const b=new TextDecoder;function e(t,n=""){const a=document.createElement("div");a.textContent=`[${new Date().toLocaleTimeString()}] ${t}`,n&&(a.className=n),d.appendChild(a),d.scrollTop=d.scrollHeight}r.addEventListener("click",async()=>{try{const t=document.getElementById("url").value,n=document.getElementById("path").value;r.disabled=!0,c.disabled=!1,s=!0,e(`Connecting to ${t}...`),o=await g(new URL(t)),e("Connected!"),e(`Subscribing to broadcast: ${n}`);const a=o.consume(m(n));e("Got broadcast handle"),e("Subscribing to track: serial");const u=a.subscribe("serial",0);for(e("Subscribed to track, waiting for data...");s;){e("Waiting for next group...");const l=await u.nextGroup();if(!l){e("No more groups");break}for(e(`Got group ${l.sequence}`);s;){const i=await l.readFrame();if(!i){e("End of group");break}e(`Data: ${b.decode(i)}`,"data")}}e("Loop ended")}catch(t){e(`Error: ${t.message}`,"error"),console.error(t)}finally{r.disabled=!1,c.disabled=!0}});c.addEventListener("click",async()=>{e("Stopping..."),s=!1,await(o==null?void 0:o.close()),o=null,r.disabled=!1,c.disabled=!0});
